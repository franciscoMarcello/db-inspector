<div class="app-shell" [class.dark-theme]="theme === 'dark'">
  <mat-toolbar class="app-toolbar">
    <span class="title">AgroReport</span>
    @if (activeNameValue && isLoggedIn) {
    <span class="env">Ambiente: {{ activeNameValue }}</span>
    }

    <span class="spacer"></span>

    @if (isLoggedIn) {
    @if (canViewSchemas) {
    <button mat-button class="nav-btn" routerLink="/schemas" routerLinkActive="active">
      Esquemas
    </button>
    }

    @if (canExecuteSql) {
    <button mat-button class="nav-btn" routerLink="/query" routerLinkActive="active">
      Executar SQL
    </button>
    }

    @if (canViewSchedules) {
    <button mat-button class="nav-btn" routerLink="/schedules" routerLinkActive="active">
      Agendamentos
    </button>
    }

    <button
      mat-button
      class="nav-btn"
      routerLink="/reports"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
    >
      Relatorios
    </button>

    @if (canManageReports) {
    <button
      mat-button
      class="nav-btn"
      routerLink="/reports/manage"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
    >
      Gerenciar Relatorios
    </button>
    }

    @if (isAdmin) {
    <button mat-button class="nav-btn" routerLink="/admin/users" routerLinkActive="active">
      Usuários
    </button>
    }

    <button mat-button class="nav-btn" (click)="logout()">Sair</button>
    }

    <button mat-icon-button class="theme-toggle" (click)="toggleTheme()" aria-label="Alternar tema">
      <mat-icon>
        {{ theme === 'dark' ? 'dark_mode' : 'light_mode' }}
      </mat-icon>
    </button>
  </mat-toolbar>

  <div class="page">
    <router-outlet></router-outlet>
  </div>

  <footer class="app-footer">
    <span>Versão {{ appVersion }}</span>
    <span class="footer-center">Developed by PowerRov</span>
  </footer>
</div>
